{
  "phase": 2,
  "sprint": 4,
  "title": "Toolbar Tests",
  "priority": "MEDIUM",
  "effort": "90 minutes",
  "status": "pending",
  "completedAt": null,
  "implementationNotes": null,
  "impact": "Tests all toolbar actions including file operations and exports",
  "targetMetrics": {
    "coverage": {
      "current": "0%",
      "target": "90%+ for all toolbar/*.ts files"
    }
  },
  "tasks": [
    {
      "id": "2.4.1",
      "category": "testing",
      "title": "Create new-diagram.test.ts",
      "description": "Test new diagram action with 5 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.2,
      "agent": "haiku",
      "files": ["test/toolbar/new-diagram.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupNewDiagramAction() - attaches click handler",
        "Click - replaces editor content with default snippet",
        "Click - calls schedulePreviewRender",
        "Click - calls onPathChange with null",
        "Click - respects shouldReplace() returning false"
      ],
      "acceptanceCriteria": ["5 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.2",
      "category": "testing",
      "title": "Create open-diagram.test.ts",
      "description": "Test open diagram action with 6 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.25,
      "agent": "haiku",
      "files": ["test/toolbar/open-diagram.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupOpenDiagramAction() - attaches click handler",
        "Click - opens file dialog with .dot/.gv filters",
        "Click - loads selected file content",
        "Click - updates editor with file content",
        "Click - calls onPathChange with file path",
        "Click - handles dialog cancel gracefully"
      ],
      "acceptanceCriteria": ["6 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.3",
      "category": "testing",
      "title": "Create save-diagram.test.ts",
      "description": "Test save diagram action with 6 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.25,
      "agent": "haiku",
      "files": ["test/toolbar/save-diagram.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupSaveDiagramAction() - attaches click handler",
        "Click - opens save dialog with .dot default",
        "Click - writes editor content to file",
        "Click - calls onPathChange with saved path",
        "Click - uses existing path if available (save vs save-as)",
        "Click - handles dialog cancel gracefully"
      ],
      "acceptanceCriteria": ["6 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.4",
      "category": "testing",
      "title": "Create export-diagram.test.ts",
      "description": "Test export functionality with 8 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.3,
      "agent": "sonnet",
      "files": ["test/toolbar/export-diagram.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "exportDiagram() - renders diagram to SVG",
        "exportDiagram() - normalizes SVG dimensions",
        "Export PNG - creates canvas and draws SVG",
        "Export PNG - saves as blob to file",
        "Export PNG @2x - doubles resolution",
        "Export SVG - saves raw SVG string",
        "Export - uses correct filename extension",
        "Export - handles render errors"
      ],
      "acceptanceCriteria": ["8 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.5",
      "category": "testing",
      "title": "Create actions.test.ts",
      "description": "Test toolbar actions setup with 5 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.2,
      "agent": "haiku",
      "files": ["test/toolbar/actions.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupToolbarActions() - wires all buttons",
        "loadExamples() - loads .dot files from examples/",
        "loadExamples() - parses example IDs correctly",
        "loadExamples() - sorts examples by order",
        "Example click - loads content into editor"
      ],
      "acceptanceCriteria": ["5 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.6",
      "category": "testing",
      "title": "Create examples-menu.test.ts",
      "description": "Test examples menu with 4 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.15,
      "agent": "haiku",
      "files": ["test/toolbar/examples-menu.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupExamplesMenu() - creates menu element",
        "Menu - shows on button click",
        "Menu - hides on outside click",
        "Menu item click - loads example content"
      ],
      "acceptanceCriteria": ["4 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.7",
      "category": "testing",
      "title": "Create export-menu.test.ts",
      "description": "Test export menu with 4 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.1,
      "agent": "haiku",
      "files": ["test/toolbar/export-menu.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupExportMenu() - creates menu element",
        "Menu - shows on button click",
        "Menu - hides on outside click",
        "Menu item click - triggers export"
      ],
      "acceptanceCriteria": ["4 test cases pass", "90%+ coverage"]
    },
    {
      "id": "2.4.8",
      "category": "testing",
      "title": "Create shortcuts.test.ts",
      "description": "Test keyboard shortcuts with 4 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.1,
      "agent": "haiku",
      "files": ["test/toolbar/shortcuts.test.ts"],
      "testCategories": ["unit"],
      "testCases": [
        "setupKeyboardShortcuts() - registers event listeners",
        "Ctrl+N - triggers new diagram",
        "Ctrl+O - triggers open dialog",
        "Ctrl+S - triggers save"
      ],
      "acceptanceCriteria": ["4 test cases pass", "90%+ coverage"]
    }
  ],
  "successCriteria": [
    "All eight test files created",
    "42 total test cases pass",
    "Toolbar files at 90%+ coverage",
    "pnpm test passes"
  ],
  "filesCreated": [
    "test/toolbar/new-diagram.test.ts",
    "test/toolbar/open-diagram.test.ts",
    "test/toolbar/save-diagram.test.ts",
    "test/toolbar/export-diagram.test.ts",
    "test/toolbar/actions.test.ts",
    "test/toolbar/examples-menu.test.ts",
    "test/toolbar/export-menu.test.ts",
    "test/toolbar/shortcuts.test.ts"
  ],
  "filesModified": [],
  "totalNewTests": 42,
  "totalEstimatedHours": 1.55,
  "dependencies": ["Sprint 2.1"],
  "notes": [
    "Requires Tauri API mocks",
    "File operations need mock filesystem",
    "Export tests may need canvas mocking"
  ]
}
