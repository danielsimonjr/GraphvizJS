{
  "phase": 2,
  "sprint": 2,
  "title": "Core Rendering Tests",
  "priority": "HIGH",
  "effort": "90 minutes",
  "status": "pending",
  "completedAt": null,
  "implementationNotes": null,
  "impact": "Tests critical rendering pipeline - highest priority for coverage",
  "targetMetrics": {
    "coverage": {
      "current": "0%",
      "target": "90%+ for graphviz.ts, render.ts, language.ts"
    }
  },
  "tasks": [
    {
      "id": "2.2.1",
      "category": "testing",
      "title": "Create graphviz.test.ts",
      "description": "Test the Graphviz WASM wrapper with 12 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.5,
      "agent": "sonnet",
      "files": ["test/preview/graphviz.test.ts"],
      "testCategories": ["unit"],
      "implementation": {
        "purpose": "Verify Graphviz initialization and rendering",
        "keyDecisions": [
          "Mock @hpcc-js/wasm module",
          "Test singleton pattern",
          "Test all layout engines",
          "Test error handling"
        ]
      },
      "testCases": [
        "initGraphviz() - successful initialization",
        "initGraphviz() - singleton pattern (only loads once)",
        "renderDotToSvg() - renders simple digraph",
        "renderDotToSvg() - renders undirected graph",
        "renderDotToSvg() - handles empty input",
        "renderDotToSvg() - handles invalid DOT syntax (throws)",
        "renderDotToSvg() - uses default 'dot' engine",
        "renderDotToSvg() - respects custom layout engine",
        "renderDotToSvg() - auto-initializes if not ready",
        "isGraphvizReady() - returns false before init",
        "isGraphvizReady() - returns true after init",
        "LayoutEngine type - validates all 8 engines"
      ],
      "acceptanceCriteria": [
        "12 test cases pass",
        "100% coverage of graphviz.ts",
        "Error conditions tested"
      ]
    },
    {
      "id": "2.2.2",
      "category": "testing",
      "title": "Create render.test.ts",
      "description": "Test the preview rendering system with 10 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.5,
      "agent": "sonnet",
      "files": ["test/preview/render.test.ts"],
      "testCategories": ["unit"],
      "implementation": {
        "purpose": "Verify preview rendering and callbacks",
        "keyDecisions": [
          "Mock graphviz module",
          "Test all callback invocations",
          "Test debounce behavior",
          "Test DOM updates"
        ]
      },
      "testCases": [
        "createPreview() - returns scheduler function",
        "Scheduler - calls onRenderStart callback",
        "Scheduler - calls onRenderSuccess on valid DOT",
        "Scheduler - calls onRenderError on invalid DOT",
        "Scheduler - calls onRenderEmpty on empty input",
        "Scheduler - debounces rapid calls",
        "Scheduler - cancels stale renders (token check)",
        "showPreviewMessage() - displays message correctly",
        "showPreviewError() - displays error with details",
        "Preview element - updates classList correctly"
      ],
      "acceptanceCriteria": [
        "10 test cases pass",
        "90%+ coverage of render.ts",
        "Callback order verified"
      ]
    },
    {
      "id": "2.2.3",
      "category": "testing",
      "title": "Create language.test.ts",
      "description": "Test DOT syntax highlighting with 15 test cases.",
      "status": "pending",
      "implementationNotes": null,
      "estimatedHours": 0.5,
      "agent": "sonnet",
      "files": ["test/editor/language.test.ts"],
      "testCategories": ["unit"],
      "implementation": {
        "purpose": "Verify DOT language tokenization",
        "keyDecisions": [
          "Test each token type",
          "Test keyword recognition",
          "Test operator recognition",
          "Test comment styles"
        ]
      },
      "testCases": [
        "createDotLanguage() - returns Extension",
        "Token - recognizes 'digraph' as keyword",
        "Token - recognizes 'graph' as keyword",
        "Token - recognizes 'subgraph' as keyword",
        "Token - recognizes 'node' as keyword",
        "Token - recognizes 'edge' as keyword",
        "Token - recognizes 'strict' as keyword",
        "Token - recognizes '->' as operator",
        "Token - recognizes '--' as operator",
        "Token - recognizes '//' comments",
        "Token - recognizes '/* */' comments",
        "Token - recognizes double-quoted strings",
        "Token - recognizes HTML labels '<...>'",
        "Token - recognizes attributes (label, color, shape)",
        "Token - recognizes numbers"
      ],
      "acceptanceCriteria": [
        "15 test cases pass",
        "90%+ coverage of language.ts",
        "All token types verified"
      ]
    }
  ],
  "successCriteria": [
    "All three test files created",
    "37 total test cases pass",
    "Core rendering files at 90%+ coverage",
    "pnpm test passes"
  ],
  "filesCreated": [
    "test/preview/graphviz.test.ts",
    "test/preview/render.test.ts",
    "test/editor/language.test.ts"
  ],
  "filesModified": [],
  "totalNewTests": 37,
  "totalEstimatedHours": 1.5,
  "dependencies": ["Sprint 2.1"],
  "notes": [
    "These are the most critical tests for the application",
    "graphviz.ts requires mocking the WASM module",
    "language.ts tests may need CodeMirror StreamLanguage mocking"
  ]
}
